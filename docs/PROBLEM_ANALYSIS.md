# ุชุญููู ุนููู ูููุดููุฉ: ูุดู ุฅูุดุงุก Cloud Agents ุนุจุฑ Cursor API

## ๐ ููุฎุต ุงููุดููุฉ

ุงููุธุงู ููุดู ูู ุฅูุดุงุก Cloud Agents ุนุจุฑ Cursor API ุจุณุจุจ **ุนุฏู ุชูุงูู ุจููุฉ ุงูู payload** ูุน ุงููุชุทูุจุงุช ุงูุฌุฏูุฏุฉ ูู API. ุจุงูุฅุถุงูุฉ ุฅูู ุฐููุ **ุงููููุฐุฌ ุงูุงูุชุฑุงุถู** (`claude-sonnet-4`) ูู ูุนุฏ ูุชุงุญุงู ูู Cursor API.

---

## ๐ ุงููุดููุฉ ุงูุฃุณุงุณูุฉ (Root Cause)

### 1. ุชุบููุฑ ุจููุฉ Cursor API Payload

**ุงููุดููุฉ:**
- Cursor API ุชุบูุฑ ุจููุฉ ุงูู payload ุงููุทููุจุฉ ูุฅูุดุงุก Cloud Agents
- ุงููุธุงู ูุงู ูุณุชุฎุฏู ุงูุจููุฉ ุงููุฏููุฉ: `{ repository, ref, autoCreatePr }` ูุญููู ูุณุชููุฉ
- Cursor API ุงูุขู ูุชุทูุจ ุงูุจููุฉ ุงูุฌุฏูุฏุฉ: `{ source: { repository, ref }, target: { autoCreatePr } }`

**ุงูุฎุทุฃ ุงูุฐู ูุธูุฑ:**
```json
{
  "error": "Invalid creation request parameters",
  "details": [{
    "code": "unrecognized_keys",
    "message": "Unrecognized key(s) in object: 'repository', 'ref', 'autoCreatePr'",
    "path": [],
    "keys": ["repository", "ref", "autoCreatePr"]
  }]
}
```

**ุงูุณุจุจ ุงูุฌุฐุฑู:**
- Cursor API ูุงู ุจุชุญุฏูุซ API specification
- ุงููุธุงู ูู ูุชู ุชุญุฏูุซู ููุชูุงูู ูุน ุงูุจููุฉ ุงูุฌุฏูุฏุฉ
- ุงูููุฏ ูุงู ูุณุชุฎุฏู ุงูุจููุฉ ุงููุณุทุญุฉ (flat structure) ุจุฏูุงู ูู ุงูุจููุฉ ุงููุชุฏุงุฎูุฉ (nested structure)

---

### 2. ุงููููุฐุฌ ุงูุงูุชุฑุงุถู ุบูุฑ ูุชุงุญ

**ุงููุดููุฉ:**
- ุงููููุฐุฌ ุงูุงูุชุฑุงุถู `claude-sonnet-4` ูู ูุนุฏ ูุชุงุญุงู ูู Cursor API
- ุงูููุงุฐุฌ ุงููุชุงุญุฉ ุญุงููุงู:
  - `claude-4.5-opus-high-thinking`
  - `gpt-5.2`
  - `gpt-5.2-high`
  - `gemini-3-pro`
  - `gemini-3-flash`

**ุงูุฎุทุฃ ุงูุฐู ูุธูุฑ:**
```json
{
  "error": "Model 'claude-sonnet-4' is not available or invalid."
}
```

**ุงูุณุจุจ ุงูุฌุฐุฑู:**
- Cursor API ูุงู ุจุฅุฒุงูุฉ ุงููููุฐุฌ ุงููุฏูู
- ุงููุธุงู ูุง ูุฒุงู ูุณุชุฎุฏู ุงููููุฐุฌ ุงููุฏูู ููููุฉ ุงูุชุฑุงุถูุฉ ูู ุนุฏุฉ ุฃูุงูู
- ูู ูุชู ุชุญุฏูุซ ุงูููู ุงูุงูุชุฑุงุถูุฉ ุจุนุฏ ุชุบููุฑ API

---

## ๐ ุชุฃุซูุฑ ุงููุดููุฉ

### ุนูู ุงููุธุงู:
1. **ูุดู ุฌููุน ูุญุงููุงุช ุฅูุดุงุก Orchestrations** - 100% failure rate
2. **ุนุฏู ุฅููุงููุฉ ุฅูุดุงุก Cloud Agents** - ุงููุธุงู ุงูุฃุณุงุณู ูุนุทู
3. **ููุฏุงู ุงูุจูุงูุงุช** - Orchestrations ุชุจูู ูู ุญุงูุฉ `ERROR` ุจุฏูู ุฅููุงููุฉ ุงูุฅุตูุงุญ
4. **ุงุณุชููุงู ุงูุญุฏ ุงููููู** - 10 orchestrations ูุงุดูุฉ ุงุณุชูููุช ุงูุญุฏ ุงููููู

### ุนูู ุงููุณุชุฎุฏููู:
1. **ุนุฏู ุงููุฏุฑุฉ ุนูู ุงุณุชุฎุฏุงู ุงููุธุงู** - ุฌููุน ุงููุญุงููุงุช ุชูุดู
2. **ุฑุณุงุฆู ุฎุทุฃ ุบูุฑ ูุงุถุญุฉ** - `[object Object]` ูู ุจุนุถ ุงูุญุงูุงุช
3. **ููุฏุงู ุงูููุช** - ูุญุงููุงุช ูุชูุฑุฑุฉ ุจุฏูู ูุชูุฌุฉ

---

## ๐ง ุงูุฅุตูุงุญุงุช ุงููุทุจูุฉ

### 1. ุชุญุฏูุซ ุจููุฉ Payload

**ูุจู:**
```typescript
{
  prompt: { text: string },
  repository: string,        // โ ุบูุฑ ูุนุชุฑู ุจู
  ref: string,              // โ ุบูุฑ ูุนุชุฑู ุจู
  model: string,
  autoCreatePr: boolean,     // โ ุบูุฑ ูุนุชุฑู ุจู
  webhook?: {...}
}
```

**ุจุนุฏ:**
```typescript
{
  prompt: { text: string },
  source: {                 // โ ุงูุจููุฉ ุงูุฌุฏูุฏุฉ
    repository: string,
    ref: string
  },
  target: {                 // โ ุงูุจููุฉ ุงูุฌุฏูุฏุฉ
    autoCreatePr: boolean
  },
  model: string,
  webhook?: {...}
}
```

**ุงููููุงุช ุงููุญุฏุซุฉ:**
- `orchestrator/src/services/task-dispatcher.service.ts` - ุงูููุทู ุงูุฃุณุงุณู
- `src/infrastructure/cursor-cloud-agents/client.ts` - Interface definition
- `app/api/cloud-agents/agents/route.ts` - API route handler

---

### 2. ุชุญุฏูุซ ุงููููุฐุฌ ุงูุงูุชุฑุงุถู

**ูุจู:** `claude-sonnet-4` (ุบูุฑ ูุชุงุญ)

**ุจุนุฏ:** `claude-4.5-opus-high-thinking` (ูุชุงุญ)

**ุงููููุงุช ุงููุญุฏุซุฉ:**
- `orchestrator/src/services/task-dispatcher.service.ts`
- `orchestrator/src/services/outbox-processor.service.ts`
- `orchestrator/src/services/analyzer.service.ts`
- `orchestrator/src/services/task-planner.service.ts`
- `app/api/cloud-agents/orchestrate/route.ts`
- `app/api/cloud-agents/orchestrate/dry-run/route.ts`
- ูุงุนุฏุฉ ุงูุจูุงูุงุช: `ALTER TABLE orchestrations ALTER COLUMN model SET DEFAULT 'claude-4.5-opus-high-thinking'`

---

## ๐ ุงูุฅุญุตุงุฆูุงุช

### ุงูุญุฏ ุงููููู (Daily Limit):
- **ุงูุญุฏ ุงูุฃูุตู:** 10 orchestrations ูู ุงูููู
- **ุงููุณุชุฎุฏู ุงูููู:** 10 orchestrations (100% ูู ุงูุญุฏ)
- **ุงูุญุงูุฉ:** ุชู ุงููุตูู ููุญุฏ ุงููููู

### Orchestrations ุงูููู:
1. `56cb10c1` - `running` - `claude-4.5-opus-high-thinking` โ
2. `12686b69` - `error` - `claude-sonnet-4` โ
3. `eeb989eb` - `error` - `claude-sonnet-4` โ
4. `81081e9c` - `error` - `claude-sonnet-4` โ
5. `d40c42e2` - `error` - `claude-sonnet-4` โ
6-10. orchestrations ุฃุฎุฑู ูุงุดูุฉ

---

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ

### ูุตูุฑุฉ ุงููุฏู:
1. โ **ุชู ุฅุตูุงุญ ุจููุฉ Payload** - ุฌุงูุฒ ููุงุฎุชุจุงุฑ
2. โ **ุชู ุชุญุฏูุซ ุงููููุฐุฌ ุงูุงูุชุฑุงุถู** - ุฌุงูุฒ ููุงุฎุชุจุงุฑ
3. โณ **ุงุฎุชุจุงุฑ E2E** - ุจุนุฏ ุงูุชูุงุก ุงูุญุฏ ุงููููู
4. โณ **ูุฑุงูุจุฉ ุงููุชุงุฆุฌ** - ุงูุชุญูู ูู ูุฌุงุญ Orchestrations ุงูุฌุฏูุฏุฉ

### ูุชูุณุทุฉ ุงููุฏู:
1. **ุฅุถุงูุฉ ุขููุฉ ุชุญุฏูุซ ุชููุงุฆูุฉ** - ููุชุญูู ูู ุงูููุงุฐุฌ ุงููุชุงุญุฉ
2. **ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก** - ุฑุณุงุฆู ุฃูุถุญ ูููุณุชุฎุฏููู
3. **ุฅุถุงูุฉ retry logic** - ููุชุนุงูู ูุน ุชุบููุฑุงุช API ุงููุณุชูุจููุฉ

### ุทูููุฉ ุงููุฏู:
1. **ูุธุงู ุฅุดุนุงุฑุงุช** - ุนูุฏ ุชุบููุฑ API specifications
2. **Versioning ููู API** - ููุชุนุงูู ูุน ุงูุชุบููุฑุงุช ุงููุณุชูุจููุฉ
3. **Automated testing** - ููุชุญูู ูู ุชูุงูู API

---

## ๐ ุงูุฃูุงู ูุงูููุซูููุฉ

### ุงููุดุงูู ุงูููุชุดูุฉ:
1. **ุนุฏู ูุฌูุฏ fallback mechanism** - ุนูุฏ ูุดู API
2. **ุนุฏู ูุฌูุฏ versioning** - ููุชุนุงูู ูุน ุชุบููุฑุงุช API
3. **ุนุฏู ูุฌูุฏ monitoring** - ููุชุญูู ูู ุชุบููุฑุงุช API

### ุงูุชุญุณููุงุช ุงูููุชุฑุญุฉ:
1. **API Version Detection** - ููุชุญูู ูู ุงููุณุฎุฉ ุงููุณุชุฎุฏูุฉ
2. **Automatic Model Discovery** - ููุชุญูู ูู ุงูููุงุฐุฌ ุงููุชุงุญุฉ
3. **Health Checks** - ููุชุญูู ูู ุญุงูุฉ Cursor API

---

## ๐ ุงูุฏุฑูุณ ุงููุณุชูุงุฏุฉ

1. **API Changes are Breaking** - ุชุบููุฑุงุช API ูููู ุฃู ุชุนุทู ุงููุธุงู ุจุงููุงูู
2. **Default Values Matter** - ุงูููู ุงูุงูุชุฑุงุถูุฉ ูุฌุจ ุฃู ุชููู ูุงุจูุฉ ููุชุญุฏูุซ
3. **Testing is Critical** - ุงูุงุฎุชุจุงุฑ ุงููุณุชูุฑ ุถุฑูุฑู ูููุดู ุนู ุงููุดุงูู
4. **Monitoring is Essential** - ุงููุฑุงูุจุฉ ุชุณุงุนุฏ ูู ุงูุชุดุงู ุงููุดุงูู ูุจูุฑุงู

---

## โ ุญุงูุฉ ุงูุฅุตูุงุญ

- โ **ุจููุฉ Payload** - ุชู ุงูุฅุตูุงุญ
- โ **ุงููููุฐุฌ ุงูุงูุชุฑุงุถู** - ุชู ุงูุชุญุฏูุซ
- โ **ูุงุนุฏุฉ ุงูุจูุงูุงุช** - ุชู ุงูุชุญุฏูุซ
- โ **Worker** - ุชู ุฅุนุงุฏุฉ ุงูุจูุงุก
- โณ **ุงูุงุฎุชุจุงุฑ ุงูููุงุฆู** - ูู ุงูุชุธุงุฑ ุงูุชูุงุก ุงูุญุฏ ุงููููู

---

**ุชุงุฑูุฎ ุงูุชุญููู:** 2025-12-20  
**ุขุฎุฑ ุชุญุฏูุซ:** 2025-12-20 23:15 UTC

